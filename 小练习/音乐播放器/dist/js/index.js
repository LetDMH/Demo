!function(n,s){function t(t){this.wrap=t,this.controlIndex=null,this.dataList=[],this.timer=null,this.list=null}t.prototype={init:function(){this.getDom(),this.getData("../mock/data.json")},getDom:function(){this.controlBtns=document.querySelectorAll(".control li"),this.img=document.querySelector(".songImg img")},getData:function(t){var i=this;n.ajax({url:t,method:"get",success:function(t){i.dataList=t,i.listChange(),i.controlIndex=new s.controlIndex(t.length),i.loadMusic(i.controlIndex.index),i.controlMusic()},error:function(){}})},loadMusic:function(t){s.render(this.dataList[t]),s.music.load(this.dataList[t].audioSrc),"playing"==s.music.status&&(s.music.play(),this.controlBtns[2].className="play",this.imgRotate(0)),this.index=t},controlMusic:function(){var t=this;this.controlBtns[1].addEventListener("touchend",function(){s.music.status="playing",t.loadMusic(t.controlIndex.pre())}),this.controlBtns[3].addEventListener("touchend",function(){s.music.status="playing",t.loadMusic(t.controlIndex.next())}),this.controlBtns[2].addEventListener("touchend",function(){"playing"==s.music.status?(s.music.pause(),s.music.status="pause",this.className="",t.stopRotate()):(s.music.play(),s.music.status="playing",this.className="play",t.imgRotate(t.img.dataset.rotate||0))})},imgRotate:function(t){var i=this;this.timer||(this.timer=setInterval(function(){t=+t+.2,i.img.style.transform="rotate("+t+"deg)",i.img.dataset.rotate=t},1e3/60))},stopRotate:function(){clearInterval(this.timer),this.timer=null},listChange:function(){var n=this;this.list=s.listRender(this.dataList,this.wrap),this.controlBtns[4].addEventListener("touchend",function(){n.list.slideUp()}),this.list.musicList.forEach(function(t,i){t.addEventListener("touchend",function(){n.index!=i&&(s.music.status="playing",n.controlIndex.index=i,n.loadMusic(i),n.list.slideDown())})})}},new t(document.getElementById("wrap")).init()}(window.Zepto,window.player);